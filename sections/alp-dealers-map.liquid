{% schema %}
{
  "name": "Alp Dealers Map",
  "class": "alp-dealers-map",
  "settings": [
    {
      "type": "text",
      "id": "bigtitle",
      "label": "Big Title",
      "default": "FIND A DEALER NEAR ME"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "container",
      "label": "Layout",
      "default": "alp-container",
      "options": [
        {
          "value": "alp-container",
          "label": "Default"
        },
        {
          "value": "alp-container-fluid",
          "label": "Fluid container"
        },
        {
          "value": "alp-full-width",
          "label": "Full width"
        }
      ]
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "default": 10,
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "em"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "default": 10,
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "em"
    },
    {
      "type": "checkbox",
      "id": "reset_spacing",
      "label": "Remove default space between sections",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "Text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Personalized Service"
        },
        {
          "type": "richtext",
          "id": "des",
          "label": "Description",
          "default": "<p>Our dealers are trained experts who can help by understanding your needs and guide you towards the perfect ebike along with answering any questions you may have.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Alp Dealers Map"
    }
  ]
}
{% endschema %}

{% liquid
  assign st = section.settings
  assign container = st.container
  assign reset_spacing = ''
  if st.reset_spacing
    assign reset_spacing = ' remove_spacing'
  endif
%}

{%- capture style -%}
    --bg-color: {{ st.bg_color }};--text-color: {{ st.text_color }};--padding-top: {{ st.padding_top }};--padding-bottom: {{ st.padding_bottom }};
{%- endcapture -%}

{% style %}
  .alp-dealers-map-bigtitle {
    color: #e83f0c;
  }
  .alp-dealers-map-text {
    display: flex;
    margin-top: calc(var(--alp-gutter-y) * 2);
  }
  .alp-dealers-map-item {
    width: 50%;
  }
  .alp-dealers-map-desc {
    width: 80%;
    text-transform: capitalize;
  }
  div#new-mokwheel-locator-wrap div#storemapper {
    padding: 0;
    margin: 0;
  }
  @media screen and (max-width: 999px) {
    .alp-dealers-map-box {
      margin-top: 0;
    }
    .alp-dealers-map-text {
      flex-direction: column;
      gap: 3em;
    }
    .alp-dealers-map-item {
      width: 100%;
    }
    .alp-dealers-map-desc {
      width: 100%;
    }
  }
{% endstyle %}

<div class="alp-dealers-map alp-section {{ reset_spacing }}" style="{{ style }}">
  <div class="alp-dealers-map-con alp-section-container page-width {{ container }}">
    <h2 class="alp-dealers-map-bigtitle headline__h3">{{ st.bigtitle }}</h2>
    {% comment %}
      <div class="alp-dealers-map-box" id="beeline-locator-wrap">

        <div class="beeline-container" id="beeline-locator">
          <script id="beeline-locator-script" async></script>
          <script>
            // Beeline dealer locator for Mokwheel
            (function () {
              const config = {
                api_key: 'PuDPMYB3LqBvNP8B0byLuVTYezfkSoQwJEGEmCkXNp8',
                search_type: 'locator',
                tags: '',
                title: 'Find a Dealer',
                search_text: 'Search for Dealers within',
                map_style: 'standard',
                primary_button: '#ed751e',
                primary_button_hover: '#484746',
                secondary_button: '#ffffff',
                secondary_button_hover: '#6c757d',
                selected_button: '#ed751e',
                custom_marker_url: 'https://beeline-public.s3.us-west-2.amazonaws.com/markers/mokwheel_default_v4.svg',
                custom_selected_marker_url:
                  'https://beeline-public.s3.us-west-2.amazonaws.com/markers/mockwheel_default_v4.svg',
                custom_badge_marker_url:
                  'https://beeline-public.s3.us-west-2.amazonaws.com/markers/mokwheel_special_v2.svg',
                custom_badge_selected_marker_url:
                  'https://beeline-public.s3.us-west-2.amazonaws.com/markers/mockwheel_special_v2.svg',
                custom_tag: 'official_dealership',
                opaque: 'true',
              };

              const qs = Object.keys(config)
                .reduce(function (a, k) {
                  a.push(encodeURIComponent(k) + '=' + encodeURIComponent(config[k]));
                  return a;
                }, [])
                .join('&');

              document.getElementById('beeline-locator-script').src =
                'https://brand-api.beelineconnect.com/embed/locator.js?' + qs;
            })();
          </script>
        </div>
      </div>
    {% endcomment %}
    <div class="alp-dealers-map-box" id="new-mokwheel-locator-wrap">
      <div id="storemapper" style="width:100%;"></div>
      <script
        data-storemapper-start="2025,07,22"
        data-storemapper-id="34368-J73jV7AIolM8BoEq"
      >
        (function () {
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.async = true;
          script.src = 'https://www.storemapper.co/js/widget-3.min.js';
          var entry = document.getElementsByTagName('script')[0];
          entry.parentNode.insertBefore(script, entry);
        })();
      </script>
    </div>
    {% if section.blocks.size > 0 %}
      <div class="alp-dealers-map-text">
        {%- if section.blocks.size > 0 -%}
          {%- for block in section.blocks -%}
            {% liquid
              assign bs = block.settings
            %}
            <div class="alp-dealers-map-item">
              <h2 class="alp-dealers-map-title headline__h3">{{ bs.title }}</h2>
              <div class="alp-dealers-map-desc">{{ bs.des }}</div>
            </div>
          {%- endfor -%}
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    //
  });
</script>
