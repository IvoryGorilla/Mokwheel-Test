{% comment %}
  Usage:
  {% render 'alp-addional-product-item', product: product, properties: false %}
{% endcomment %}

{%- assign add_properties = properties | default: false -%}
{%- assign variant = product.first_available_variant -%}

<div
  class="alp-addional-product-item-new {{ class }}"
  data-variantPrice=""
  data-productId="{{- product.id -}}"
  data-promotion-pack
  data-pack-variant="{{ product.first_available_variant.id }}"
>
  <div class="alp-addional-product-flex">
    <div class="alp-addional-product-image">
      {{ product.featured_image | image_url: width: 300 | image_tag: loading: 'lazy' }}
      {% render 'icon-check-2' %}
    </div>
    <div class="alp-addional-product-content">
      <div class="alp-addional-product-title">
        <div>
          {%- if product.metafields.custom.additional_options_title != blank -%}
            {{ product.metafields.custom.additional_options_title }}
          {%- else -%}
            {{ product.title }}
          {%- endif -%}
        </div>
      </div>
      <div class="alp-addional-product-description">
        {%- if product.metafields.custom.new_description != blank -%}
          {{ product.metafields.custom.new_description | truncatewords: 6 }}
        {%- elsif product.description != blank -%}
          {{ product.description | truncatewords: 6 | strip_html }}
        {%- else -%}
          Select {{ product.title }} For Your E-Bike
        {%- endif -%}
      </div>
      <div class="alp-addional-product-price">
        {%- if product.metafields.custom.discount_price != blank -%}
          {%- assign discount_price = product.metafields.custom.discount_price -%}
          {%- if discount_price == 0 -%}
            {%- assign discount_price = 'FREE' -%}
          {%- else -%}
            {%- assign discount_price = discount_price | money -%}
          {%- endif -%}
          <strong class="price--final" data-discount-price="{{ product.metafields.custom.discount_price }}">
            {{- discount_price -}}
          </strong>
          <s class="cart-item__old-price ">{{ product.price | money }}</s>
        {%- else -%}
          <span>{{ product.price | money }}</span>
        {%- endif -%}
      </div>
    </div>
  </div>
  {%- if add_properties -%}
    <input
      class="the-properties"
      type="hidden"
      name="properties[*Option:{{- product.title -}}]"
      value="{{ variant.title }}|{{ variant.price | money }}"
    >
    <input
      class="the-properties-id"
      type="hidden"
      name="properties[_OptionId:{{- product.title -}}]"
      value="{{ variant.id }}|{{ variant.price }}"
    >
  {%- endif -%}
</div>
