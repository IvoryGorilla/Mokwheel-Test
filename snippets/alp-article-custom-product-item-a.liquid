{% comment %}
  use snippet alp-product-item-1.liquid
  Accepts:
    product
  Usage:
  {% render 'alp-article-custom-product-item-a', product: product, block: block %}
{% endcomment %}

{% liquid
  assign bs = block.settings
%}

{%- assign show_features = show_features | default: false -%}
{%- assign show_icon_features = show_icon_features | default: true -%}
{%- assign show_discount_badge = show_discount_badge | default: true -%}
{%- assign show_reviews = show_reviews | default: true -%}
{%- assign show_description = show_description | default: true -%}

{% stylesheet %}
  .alp-product-item-grid.alp-product-item-wrapper.alp-product-item-grid-n1.alp-article-custom-product-item-a {
    display: grid;
    grid-template-columns: 1fr;
    padding: calc(var(--alp-gutter-x) * 1);
    gap: calc(var(--alp-gutter-x) * 1);
  }

  .alp-grid-container-image-custom img {
    display: block;
  }

  .alp-product-item-grid.alp-product-item-wrapper.alp-product-item-grid-n1.alp-article-custom-product-item-a
    .alp-product-item-info.p-grid {
    padding: 0;
    pointer-events: auto;
  }
  .alp-product-item-review-image img {
    aspect-ratio: auto;
    display: block;
    max-width: 250px;
  }

  .alp-product-item-review-image {
    margin-bottom: 2em;
  }

  .alp-product-item-sub-title {
    margin-bottom: 1em;
  }
  .alp-article-custom-product-item-a .alp-product-item-badges {
    display: flex;
    gap: 4px;
    flex-wrap: wrap;
    margin: 0.5em 0;
  }
  .alp-article-custom-product-item-a .alp_product__badge_i {
    background: #ff951b1a;
    color: #ff951b;
    line-height: 1.2;
    border-radius: var(--alp-border-radius);
    border: 0.5px solid #ff951b;
    font-weight: 700;
    padding: 6px 10px;
    height: auto;
  }
  .alp-article-custom-product-item-a .headline__h3 {
    font-size: clamp(18px, 2vw, 24px);
    font-weight: 600;
  }

  .alp-article-custom-product-item-a .alp-quick-add {
    font-size: 1em;
  }

  .alp-article-custom-product-item-a .list-buy-button-flex {
    font-size: 14px;
    width: 100%;
    max-width: 320px;
  }

  .alp-article-custom-product-item-a .list-buy-button-flex .list-buy-button {
    font-size: 1em;
  }

  .alp-article-custom-product-item-a.alp-product-item-grid-n1 .alp-product-item-info-buttons-flex {
    width: 100%;
    justify-content: flex-start;
    flex-direction: row;
  }

  .alp-article-custom-product-item-a .list-buy-button-flex > div {
    flex: 1;
  }

  .alp-article-custom-product-item-a .list-buy-button-flex .list-buy-button a {
    width: 100%;
    justify-content: center;
  }

  .alp-product-item-video-custom iframe {
    display: block;
    border: 0;
    width: 100%;
    height: 100%;
    aspect-ratio: 16/9;
  }
  .alp-product-item-video-custom > * {
    height: 100%;
    display: block;
  }

  .alp-article-custom-product-item-a .alp-productAcessories .productAcessories_conter {
    grid-template-columns: 1fr 1fr;
  }

  .alp-article-custom-product-item-a[data-type='type-1'] .alp-productAcessories {
    display: none;
  }
  .alp-article-custom-product-item-a[data-type='type-2'] .alp-product-item-badges {
    display: none;
  }

  @media (min-width: 768px) {
    .alp-product-item-grid.alp-product-item-wrapper.alp-product-item-grid-n1.alp-article-custom-product-item-a[data-type='type-1']
      .alp-product-item-info.p-grid {
      padding: 5% 0;
    }
    .alp-product-item-grid.alp-product-item-wrapper.alp-product-item-grid-n1.alp-article-custom-product-item-a {
      grid-template-columns: 1.2fr 1fr;
    }
  }
  @media (max-width: 768px) {
    .alp-product-item-grid.alp-product-item-wrapper.alp-product-item-grid-n1.alp-article-custom-product-item-a {
      gap: 1.5em;
    }

    .alp-product-item-review-image {
      margin-bottom: 1.5em;
    }

    .alp-product-item-sub-title {
      font-size: 12px;
      margin-bottom: 0.35em;
      opacity: 0.75;
    }
    .alp-article-custom-product-item-a .alp-productAcessories .productAcessories_conter {
      gap: 0.5em;
      padding-top: 0.5em;
    }

    .alp-article-custom-product-item-a .alp-productAcessories .productAcessories_conter .productAcessories_lsitTitle {
      font-size: 12px;
    }

    .alp-article-custom-product-item-a .alp-productAcessories .productAcessories_conter .productAcessories_lsitTitle b {
      font-size: 14px;
    }
  }
{% endstylesheet %}

<div
  class="alp-product-item-grid alp-product-item-wrapper alp-product-item-grid-n1 alp-article-custom-product-item-a"
  {% unless product.available %}
    data-is-available="false"
  {% endunless %}
  data-swatch-wrapper
  data-href="{{ product.url }}"
  {% comment %} data-variant="{{ product.first_available_variant.id }}" {% endcomment %}
  style="--aspect-ratio:{{ aspect_ratio | default: '1/1' }}"
  data-type="{{ bs.product_type }}"
>
  {% comment %} <a class="alp-product-item-link full-aa" href="{{ product.url }}" title="{{ product.title }}"></a> {% endcomment %}

  {%- if bs.video_url -%}
    {% liquid
      assign video_id = ''
      if bs.video_url.type == 'youtube'
        assign video_id = bs.video_url | replace: 'https://www.youtube.com/watch?v=', ''
      elsif bs.video_url.type == 'vimeo'
        assign video_id = bs.video_url | replace: 'https://vimeo.com/', ''
      endif
    %}
    {%- capture online_video_url -%}
    {%- if bs.video_url.type == 'youtube' -%}
    https://www.youtube.com/embed/{{ video_id }}?controls=1&autoplay=0&mute=0&playsinline=1&loop=0&playlist={{ video_id }}
    {%- elsif bs.video_url.type == 'vimeo' -%}
    https://player.vimeo.com/video/{{ video_id }}?controls=1&background=1&autoplay=0&muted=0&loop=0
    {%- endif -%}
    {%- endcapture -%}

    <div class="alp-product-item-video-custom">
      {%- if bs.video_url.type == 'youtube' -%}
        <video-youtube data-id="{{ block.id }}">
          <iframe
            src="{{ online_video_url }}"
          ></iframe>
        </video-youtube>
      {%- elsif bs.video_url.type == 'vimeo' -%}
        <iframe
          src="{{ online_video_url }}"
          frameborder="0"
          allowfullscreen
        ></iframe>
      {%- endif -%}
    </div>

  {%- elsif bs.product_image -%}
    <div class="alp-grid-container-image-custom">
      <div class="alp-product-item-image-custom">
        {{ bs.product_image | image_url: width: 800 | image_tag: loading: 'lazy' }}
      </div>
    </div>
  {%- else -%}
    <div class="alp-grid-container-image">
      {%- if product.metafields.custom.cert_icon -%}
        <div class="alp-product-cert-icon-bv alp-product-cert-icon">
          {{ product.metafields.custom.cert_icon | image_url: width: 480 | image_tag: loading: 'lazy' }}
        </div>
      {%- endif -%}

      <div class="alp-product-item-image">
        {%- if product.variants.size > 0 -%}
          {% for variant in product.variants %}
            {% liquid
              assign options_string = ''
              for option in variant.options
                assign options_string = options_string | append: option | append: ','
              endfor
            %}
            <div
              class="product-item-image-i {% if forloop.index == 1 %} active{% endif %}"
              data-variant="{{ variant.id }}"
              data-options="{{ options_string }}"
            >
              {%- assign alt_title = product.title | append: ' - ' | append: variant.title -%}
              {%- if variant.image -%}
                {% comment %}
                  {% render 'alp-single-image',
                    image: variant.image,
                    width: 1280,
                    aspect_ratio: aspect_ratio,
                    alt: alt_title
                  %}
                {% endcomment %}
                {% render 'alp-responsive-image',
                  image: variant.image,
                  desktop_width: 800,
                  mobile_width: 400,
                  aspect_ratio: aspect_ratio,
                  alt: alt_title
                %}
              {%- else -%}
                {% comment %}
                  {% render 'alp-single-image',
                    image: product.featured_image,
                    width: 1280,
                    aspect_ratio: aspect_ratio,
                    alt: product.title
                  %}
                {% endcomment %}
                {% render 'alp-responsive-image',
                  image: product.featured_image,
                  desktop_width: 800,
                  mobile_width: 400,
                  aspect_ratio: aspect_ratio,
                  alt: product.title
                %}
              {%- endif -%}
            </div>
          {% endfor %}
        {%- else -%}
          {% render 'alp-single-image',
            image: product.featured_image,
            width: 1280,
            aspect_ratio: aspect_ratio,
            alt: product.title
          %}
        {%- endif -%}
        {% render 'product-scene-image', product: product %}
        {%- assign countdown_time = product.metafields.custom.countdown_time -%}
        {%- if countdown_time != blank -%}
          <div class="alp-product-item-countdown" data-countdown="{{ countdown_time }}">
            <div>
              {% render 'icon-alarm' %}
              {% render 'alp-countdown-snippet',
                text: bs.countdown_text,
                id: product.id,
                countdown_date: countdown_time,
                countdown_hours: 768
              %}
            </div>
          </div>
        {%- endif -%}
        <a class="alp-product-item-link full-aa" href="{{ product.url }}" title="{{ product.title }}"></a>
      </div>
    </div>
  {%- endif -%}

  <div class="alp-grid-item-info-wrapper">
    <div class="alp-product-item-info p-grid">
      <div class="alp-product-item-info-flex info-flex-row">
        <div class="alp-product-item-info-grid-wrapper">
          {%- if bs.review_image -%}
            <div class="alp-product-item-review-image">
              {{ bs.review_image | image_url: width: 800 | image_tag: loading: 'lazy' }}
            </div>
          {%- endif -%}
          {%- if bs.product_sub_title != blank -%}
            <div class="alp-product-item-sub-title">
              <div class="headline__p">{{ bs.product_sub_title }}</div>
            </div>
          {%- endif -%}
          <div class="alp-product-item-title">
            <div class="alp-product-item-title-flex">
              <div class="headline__h3">{{ product.title }}</div>
              <div class="alp-product-item-color-swatch hidden">
                {% render 'alp-color-swatch-for-list', product: product %}
              </div>
            </div>
            <div class="alp-product-item-badges">
              {%- if bs.product_badges -%}
                {%- assign product_badges = bs.product_badges | split: ',' -%}
                {%- for item in product_badges -%}
                  <div class="alp_product__badge_i">{{ item }}</div>
                {%- endfor -%}
              {%- elsif product.metafields.custom.full_reduction_list -%}
                {%- for item in product.metafields.custom.full_reduction_list.value -%}
                  <div class="alp_product__badge_i">{{ item }}</div>
                {%- endfor -%}
              {%- endif -%}
            </div>
            {%- if product.metafields.custom.new_description != blank and show_description -%}
              <div class="product-list-description">
                {{- product.metafields.custom.new_description | strip_html | strip -}}
              </div>
            {%- endif -%}
          </div>
          {%- if show_reviews -%}
            <!-- Stamped - Begin Star Rating Badge -->
            <span
              class="stamped-product-reviews-badge stamped-main-badge alp-product-item-review hidden"
              data-id="{{ product.id }}"
              data-product-sku="{{ product.handle }}"
              data-product-title="{{product.title}}"
              data-product-type="{{product.type}}"
              style="display: block;"
            >
            </span>
            <!-- Stamped - End Star Rating Badge -->
          {%- endif -%}

          {% if product.metafields.custom.product_configuration.value != blank and show_icon_features %}
            <div class="alp-productAcessories ">
              <div class="productAcessories_conter">
                {% for item in product.metafields.custom.product_configuration.value %}
                  <div class="productAcessories_lsit">
                    <div class="productAcessories_lsitImg">
                      <img loading="lazy" src="{{ item.img }}" alt="" width="96" height="96">
                    </div>
                    <div class="productAcessories_lsitTitle">
                      {{ item.title }}
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endif %}
          <div class="alp-product-item-price">{% render 'price-with-variants', product: product %}</div>
          {%- if product.metafields.custom.promotion_text != blank -%}
            <div class="product-list-promotion-text">
              {{- product.metafields.custom.promotion_text | metafield_tag -}}
            </div>
          {%- endif -%}
          {% comment %}
            <div
              class="affirm-as-low-as alp-product-item"
              data-page-type="product"
              data-amount="{{ product.price }}"
            ></div>
          {% endcomment %}
          {% render 'installment-block', product: product %}
        </div>
      </div>
      <div class="alp-product-item-info-buttons-flex hs_compare_btn">
        {% render 'list-buy-button-new2', product: product %}
      </div>
    </div>
  </div>
</div>
