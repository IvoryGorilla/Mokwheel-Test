{% liquid
  assign bs = block.settings
  if show_price
    assign price_display = 'show_price'
  endif
%}

{% comment %} {% style %}
@media screen and (max-width:768px) {
  .mega-menu-richcontent-mobile-p2 {
    background:none;
  }
  .alp-icon-list-2>div {
    gap: 4px;
  }
  .alp-icon-list-2.mega-menu-icons img {
    max-width: 20px;
  }
  .mega-menu-jumplink-mobile a{
    font-family: Manrope;
    font-size: 14px;
    font-weight: 500;
    line-height: 120%;
    letter-spacing: 0px;
    color: #E83F0C;
  }
  .mega-menu-jumplink-mobile p{
    margin:15px 0;
  }
  .alp-header-block-review.hide_desktop{
    justify-content: flex-start;
    margin:15px 0;
  }
  .mega-menu-paymenticon-mobile .alp-icon-list-2.mega-menu-icons {
    gap:15px;
    padding-bottom: 24px;
  }
}
{% endstyle %} {% endcomment %}

<div
  class="slide-sub-menu-wrapper"
  data-list-style="{{ style | default: 'style_one' }}"
  data-show-price="{{ price_display | default: '' }}"
>
  <div class="slide-sub-menu-header has-swiper-nav">
    <div class="slide-menu-back-in">{% render 'icon-arrow-left' %}</div>
    <div>{{- bs.menu_title | strip -}}</div>
    <div class="slide-menu-close-in">
      {%- render 'icon-close' -%}
    </div>
    <div class="mega-category-nav-mobile">
      <div class="swiper mega-category-nav-swiper" data-blockId="{{ block.id }}">
        <div class="swiper-wrapper">
          {%- if bs.menu_a_title != blank -%}
            <div class="swiper-slide auto-width">
              <div class="h-category-list-item button-type-3">
                <span>{{ bs.menu_a_title }}</span>
              </div>
            </div>
          {%- endif -%}
          {%- if bs.menu_b_title != blank -%}
            <div class="swiper-slide auto-width">
              <div class="h-category-list-item button-type-3">
                <span>{{ bs.menu_b_title }}</span>
              </div>
            </div>
          {%- endif -%}
          {%- if bs.menu_c_title != blank -%}
            <div class="swiper-slide auto-width">
              <div class="h-category-list-item button-type-3">
                <span>{{ bs.menu_c_title }}</span>
              </div>
            </div>
          {%- endif -%}
          {%- for collection in bs.collection_list_model -%}
            <div class="swiper-slide auto-width">
              <div class="h-category-list-item button-type-3">
                <span>{{ collection.title }}</span>
              </div>
            </div>
          {%- endfor -%}
        </div>
      </div>
    </div>
  </div>
  <div class="slide-sub-menu-ul">
    <div class="mega-category-swiper-mobile">
      <div class="swiper mega-category-items-swiper" data-blockId="{{ block.id }}">
        <div class="swiper-wrapper">
          {% comment %} collection_list_a {% endcomment %}
          {%- if bs.collection_list_a -%}
            {%- assign size = 0 -%}
            {%- for collection in bs.collection_list_a -%}
              {%- assign size = size | plus: 1 -%}
            {%- endfor -%}
            {%- if size > 0 -%}
              <div class="swiper-slide">
                {% render 'nav-collection-list2', collections: bs.collection_list_a, bs: bs %}
              </div>
            {%- endif -%}
          {%- endif -%}
          {% comment %} collection_list_b {% endcomment %}
          {%- if bs.collection_list_b -%}
            {%- assign size = 0 -%}
            {%- for collection in bs.collection_list_b -%}
              {%- assign size = size | plus: 1 -%}
            {%- endfor -%}
            {%- if size > 0 -%}
              <div class="swiper-slide">
                {% render 'nav-collection-list2', collections: bs.collection_list_b, bs: bs %}
              </div>
            {%- endif -%}
          {%- endif -%}
          {% comment %} collection_list_c {% endcomment %}
          {%- if bs.collection_list_c -%}
            {%- assign size = 0 -%}
            {%- for collection in bs.collection_list_c -%}
              {%- assign size = size | plus: 1 -%}
            {%- endfor -%}
            {%- if size > 0 -%}
              <div class="swiper-slide">
                {% render 'nav-collection-list2', collections: bs.collection_list_c, bs: bs %}
              </div>
            {%- endif -%}
          {%- endif -%}
          {% comment %} collection_list_model {% endcomment %}
          {%- if bs.collection_list_model -%}
            {%- for collection in bs.collection_list_model -%}
              <div class="swiper-slide">
                {% render 'nav-product-list2', collection: collection, limit: product_limit, bs: bs %}
              </div>
            {%- endfor -%}
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>
  <div class="mega-menu-jumplink-mobile">
    {{ bs.mega_jump_link }}
  </div>
  <div class="alp-header-block-review hide_desktop {% if bs.show_review %} show_review{% endif %}">
    <a
      rel="sponsored"
      href="{{ bs.review_link }}"
      target="_blank"
      class="full-aa"
    ></a>
    <div class="icon1">
      {% render 'alp-single-image', image: bs.icon1, width: 1280 %}
    </div>
    <div class="icon2">
      {% render 'alp-single-image', image: bs.icon2, width: 1280 %}
    </div>
    <span>{{ bs.review_text }}</span>
  </div>
  <div class="mega-menu-buttons">{{ bs.mega_button_content }}</div>
  <div class="mega-menu-paymenticon-mobile">
    {{ bs.new_mega_content }}
  </div>
</div>

<script type="module">
  document.addEventListener('DOMContentLoaded', () => {
    let swiperId = '{{ block.id }}';
    let swiperIdnum = swiperId.replace(/\D/g, '');
    let swiperVar_nav = 'MegaMenu_nav' + swiperIdnum;
    let swiperVar_items = 'MegaMenu_items' + swiperIdnum;
    swiperVar_nav = new Swiper(`.mega-category-nav-swiper[data-blockId="${swiperId}"]`, {
      slidesPerView: 2,
      spaceBetween: alp_global.gap,
      centerInsufficientSlides: true,
    });
    swiperVar_items = new Swiper(`.mega-category-items-swiper[data-blockId="${swiperId}"]`, {
      spaceBetween: alp_global.gap,
      slidesPerView: 1,
      speed: 600,
      autoHeight: true,
      thumbs: {
        swiper: swiperVar_nav,
      },
    });
  });
</script>
